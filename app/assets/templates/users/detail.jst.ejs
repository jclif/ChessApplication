<nav class="profile-nav">
  <ul>
    <li class="user-search-bar clearfix">
      <label for="user_email"></label>
      <div class="ui-widget">
        <input type="text" placeholder="Search by email" name="user[email]" id="user_email"><i class="fa fa-search user-search-button"></i><br>
        <input name="user[id]" id="user_id" type="hidden">
      </div>
    </li>
  </ul>
</nav>
<div class="profile-container clearfix">
  <div class="friend-button button button-rounded button-primary" style="display: none;">Friend</div>
  <div class="unfriend-button button button-rounded button-caution" style="display: none;">Unfriend</div>
  <h1><%= user.attributes.email %></h1>
  ID: <%= user.attributes.id %><br>
  Elo: <%= user.attributes.elo %><br><br>
  Past Games:
  <ul class="past-games">
  <% user.attributes.past_games.forEach(function(pgn) { %>
  <li>
  <% var other_user_id = null; %>
    <% if (pgn.white_user_id === user.attributes.id) { %>
      <% other_user_id = pgn.black_user_id; %>
    <% } else { %>
      <% other_user_id = pgn.white_user_id; %>
    <% } %>
    At <%= pgn.created_at %> you played as
    <% if (pgn.white_user_id === user.id) { %>
      white
    <% } else { %>
      black
    <% } %>
    against user <a href="/#/users/<%= other_user_id %>"><%= other_user_id %></a>.<br>
    White's elo changed by <%= pgn.white_elo_diff %>.<br>
    Black's elo changed by <%= pgn.black_elo_diff %>.
  </li>
  <% }); %>
  </ul>
  <hr>
  Friends:
  <br>
  <% if(user.attributes.accepted_friends) { %>
    <% user.attributes.accepted_friends.forEach(function(friend) { %>
      <a href="/#/users/<%= friend.id %>">User<%= friend.id %> (<%= friend.email %>)</a><br>
    <% }); %>
  <% } %>
  <hr>
  Pending Friends:
  <br>
  <% if(user.attributes.pending_friend_requests_received) { %>
    <% user.attributes.pending_friend_requests_received.forEach(function(friend) { %>
      <a href="/#/users/<%= friend.id %>">User<%= friend.id %>< <%= friend.email %> ></a><br>
    <% }); %>
  <% } %>
  <hr>
  Denied Friends:
  <br>
  <% if(user.attributes.denied_friend_requests_received) { %>
    <% user.attributes.denied_friend_requests_received.forEach(function(friend) { %>
      <a href="/#/users/<%= friend.id %>">User<%= friend.id %>< <%= friend.email %> ></a><br>
    <% }); %>
  <% } %>
</div>

<script>
  $(document).ready(function() {
    $( "#user_email" ).autocomplete({
      source: "/users.json",
      minLength: 2,
      select: function(event, ui) {
        $('#user_id').val(ui.label);
      },
    });
  });
</script>
